define(["jquery","backbone","text!app/templates/resource-template.html","app/models/resource-model","helper","utils/config"],function(e,t,r,s,i,o){var n=t.View.extend({initialize:function(){this.render()},render:function(){var e=new s.ResourceStarCollection;e.fetch(),this.$el.empty(),_.each(this.collection.models,function(t){new c.ResourceView({model:t,$target:this.$el,resourceStarCollection:e})},this)}}),c=t.View.extend({options:null,resourceStar:null,tagName:"tr",template:"#ResourceTemplate",initialize:function(e){this.options=e||{},this.render(),this.renderStars(),this.renderResourceStar()},render:function(){var t=_.template(e(r).find(this.template).html());this.$el.empty().html(t(_.extend({},this,{helper:i},{config:o}))),this.options.$target.append(this.el)},renderStars:function(){this.$('*[tag="stars"]').html(this.model.get("stars"))},renderResourceStar:function(){var t=this.options.resourceStarCollection.where({resource_id:this.model.id});0!=t.length?this.resourceStar=t[0]:(this.resourceStar=new s.ResourceStar({resource_id:this.model.id}),this.options.resourceStarCollection.add(this.resourceStar));var i=_.template(e(r).find("#ResourceStarTemplate").html());this.$('*[tag="resource_star_container"]').empty().html(i({model:this.resourceStar}))},events:{'dblclick *[tag="delete_resource"]':"del",'click *[tag="up"]':"up",'click *[tag="down"]':"down"},del:function(t){var r=this;this.model.destroy({wait:!0,$btn:e(t.currentTarget),success:function(e,t){t&&!t.error&&r.remove()}})},save:function(t,r,s){var i=this;this.model.save({plus:r},{wait:!0,patch:!0,$btn:e(t.currentTarget),success:function(e,t){t&&!t.error&&(i.renderStars(),i.resourceStar.save({current:s},{wait:!0,success:function(e,t){t&&!t.error&&i.renderResourceStar()}}))}})},up:function(e){var t=0,r=this.resourceStar.get("current");1==r?(r=0,t=-1):0==r?(r=1,t=1):-1==r&&(r=1,t=2),this.save(e,t,r)},down:function(e){var t=0,r=this.resourceStar.get("current");1==r?(r=-1,t=-2):0==r?(r=-1,t=-1):-1==r&&(r=0,t=1),this.save(e,t,r)}}),c={ResourcesView:n,ResourceView:c};return c});